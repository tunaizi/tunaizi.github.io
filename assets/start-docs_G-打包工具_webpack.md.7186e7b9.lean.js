import { _ as _export_sfc, r as r3, i as it, f as ig } from "./chunks/framework.29e23d3c.js";
const __pageData = JSON.parse('{"title":"webpack","description":"","frontmatter":{},"headers":[{"level":2,"title":"原理","slug":"原理","link":"#原理","children":[]},{"level":2,"title":"loader原理","slug":"loader原理","link":"#loader原理","children":[]},{"level":2,"title":"plugin原理","slug":"plugin原理","link":"#plugin原理","children":[]},{"level":2,"title":"loader和plugin的区别,常用的loader和plugin","slug":"loader和plugin的区别-常用的loader和plugin","link":"#loader和plugin的区别-常用的loader和plugin","children":[]},{"level":2,"title":"tree shaking","slug":"tree-shaking","link":"#tree-shaking","children":[]},{"level":2,"title":"rollup,webpack,closure compiler差异","slug":"rollup-webpack-closure-compiler差异","link":"#rollup-webpack-closure-compiler差异","children":[]},{"level":2,"title":"webpack5","slug":"webpack5","link":"#webpack5","children":[]},{"level":2,"title":"webpack优化","slug":"webpack优化","link":"#webpack优化","children":[{"level":3,"title":"webpack异步加载原理","slug":"webpack异步加载原理","link":"#webpack异步加载原理","children":[]},{"level":3,"title":"插件功能：自动生成README文件，标题取自插件option","slug":"插件功能-自动生成readme文件-标题取自插件option","link":"#插件功能-自动生成readme文件-标题取自插件option","children":[]}]},{"level":2,"title":"参考","slug":"参考","link":"#参考","children":[]}],"relativePath":"start-docs/G-打包工具/webpack.md","filePath":"start-docs/G-打包工具/webpack.md"}');
const _sfc_main = { name: "start-docs/G-打包工具/webpack.md" };
function _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {
  return r3(), it("div", null, _cache[0] || (_cache[0] = [
    ig('<h1 id="webpack" tabindex="-1">webpack <a class="header-anchor" href="#webpack" aria-label="Permalink to &quot;webpack&quot;">​</a></h1><ul><li>webpack是一个模块打包器（module bundler）。基于tapable的插架架构，扩展性强，支持众多的loader和plugin。</li><li>webpack只能解析JS文件，所以需要loader来处理各种非js模块。</li><li>常用配置： devtool, entry, output, module,resolve,plugins,externals等。</li></ul><h2 id="原理" tabindex="-1">原理 <a class="header-anchor" href="#原理" aria-label="Permalink to &quot;原理&quot;">​</a></h2><ul><li>获取主模块内容</li><li>分析模块，安装@babel/parser包（转ast）</li><li>对模块内容进行处理 <ul><li>安装@babel/traverse包（遍历ast收集依赖）</li><li>安装@babel/core和@babel/preset-env包（es6转es5）</li></ul></li><li>递归所有模块</li><li>生成最终代码</li></ul><h2 id="loader原理" tabindex="-1">loader原理 <a class="header-anchor" href="#loader原理" aria-label="Permalink to &quot;loader原理&quot;">​</a></h2><ul><li>Loader描述了webpack如何处理非js模块（例如css,sass,ts等），并且在build中引入这些依赖。用来做模块转换。</li><li>常见loader: <ul><li>样式：sass-loader,css-loader, css-loader,</li><li>编译：babel-loader,ts-loader,</li><li>文件： file-loader,url-loader，</li><li>校验测试： jshint-loader, eslint-loader</li><li>框架： vue-loader</li></ul></li><li>写一个loader <ul><li>不能用箭头函数，使用this来接受参数 this.query</li><li>替换js文件中所有涵盖“中化石化电子商务有限公司”字样替换成“xx”</li><li>uat-replace-loader<div class="language-js codearea-link" id="26e4ei23rqu"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#66D9EF;font-style:italic;">module</span><span style="color:#F8F8F2;">.</span><span style="color:#66D9EF;font-style:italic;">exports</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> (</span><span style="color:#FD971F;font-style:italic;">source</span><span style="color:#F8F8F2;">) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> result </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> source.</span><span style="color:#A6E22E;">replace</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&quot;中化石化&quot;</span><span style="color:#F8F8F2;">, </span><span style="color:#E6DB74;">&quot;xx&quot;</span><span style="color:#F8F8F2;">);</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FD971F;">this</span><span style="color:#F8F8F2;">.</span><span style="color:#A6E22E;">callback</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">null</span><span style="color:#F8F8F2;">, result);</span></span>\n<span class="line"><span style="color:#F8F8F2;">  };</span></span></code></pre><button class="link">将此代码在线运行</button></div></li><li>在webpack.config.js中引入<div class="language-js codearea-link" id="pqswzw5rk79"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F8F8F2;">module: {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    rules: [{</span></span>\n<span class="line"><span style="color:#F8F8F2;">      test:</span><span style="color:#E6DB74;"> /</span><span style="color:#AE81FF;">\\.</span><span style="color:#E6DB74;">js</span><span style="color:#F92672;">$</span><span style="color:#E6DB74;">/</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">      use: [{</span></span>\n<span class="line"><span style="color:#F8F8F2;">        loader: </span><span style="color:#E6DB74;">&#39;uat-replace-loader&#39;</span></span>\n<span class="line"><span style="color:#F8F8F2;">      }]</span></span>\n<span class="line"><span style="color:#F8F8F2;">    }]</span></span>\n<span class="line"><span style="color:#F8F8F2;">  }</span></span></code></pre><button class="link">将此代码在线运行</button></div></li></ul></li></ul><h2 id="plugin原理" tabindex="-1">plugin原理 <a class="header-anchor" href="#plugin原理" aria-label="Permalink to &quot;plugin原理&quot;">​</a></h2><ul><li>plugin可以扩展webpack的功能，在webpack运行的生命周期中会广播出很多事件，plugin可以监听这些事件，从而扩展功能。例如打包优化、压缩，定义环境，处理各种子任务等功能。 <ul><li>常用plugin: <ul><li>CommonChunkPlugin</li><li>html-webpack-Plugin</li><li>uglifyJsPlugin</li></ul></li><li>写一个plugin插件步骤 <ul><li>编写一个js命名的函数</li><li>在它的原型是定义一个apply方法</li><li>指定挂载的webpack事件钩子</li><li>处理webpack内部实例的特定数据</li><li>功能完成后调用webpack提供的回调<div class="language-js codearea-link" id="4hs3myq2yx5"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#88846F;">// A JavaScript class.</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;font-style:italic;">class</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;text-decoration:underline;">MyExampleWebpackPlugin</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#88846F;">// Define `apply` as its prototype method which is supplied with compiler as its argument</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#A6E22E;">apply</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">compiler</span><span style="color:#F8F8F2;">) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#88846F;">// Specify the event hook to attach to</span></span>\n<span class="line"><span style="color:#F8F8F2;">      compiler.hooks.emit.</span><span style="color:#A6E22E;">tapAsync</span><span style="color:#F8F8F2;">(</span></span>\n<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#E6DB74;">&#39;MyExampleWebpackPlugin&#39;</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">        (</span><span style="color:#FD971F;font-style:italic;">compilation</span><span style="color:#F8F8F2;">, </span><span style="color:#FD971F;font-style:italic;">callback</span><span style="color:#F8F8F2;">) </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">          console.</span><span style="color:#A6E22E;">log</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;This is an example plugin!&#39;</span><span style="color:#F8F8F2;">);</span></span>\n<span class="line"><span style="color:#F8F8F2;">          console.</span><span style="color:#A6E22E;">log</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;Here’s the `compilation` object which represents a single build of assets:&#39;</span><span style="color:#F8F8F2;">, compilation);</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F8F8F2;">          </span><span style="color:#88846F;">// Manipulate the build using the plugin API provided by webpack</span></span>\n<span class="line"><span style="color:#F8F8F2;">          compilation.</span><span style="color:#A6E22E;">addModule</span><span style="color:#F8F8F2;">(</span><span style="color:#88846F;">/* ... */</span><span style="color:#F8F8F2;">);</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F8F8F2;">          </span><span style="color:#A6E22E;">callback</span><span style="color:#F8F8F2;">();</span></span>\n<span class="line"><span style="color:#F8F8F2;">        }</span></span>\n<span class="line"><span style="color:#F8F8F2;">      );</span></span>\n<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#88846F;">// other</span></span>\n<span class="line"><span style="color:#F8F8F2;">      compiler.</span><span style="color:#A6E22E;">plugin</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;event&#39;</span><span style="color:#F8F8F2;">, (</span><span style="color:#FD971F;font-style:italic;">compilation</span><span style="color:#F8F8F2;">, </span><span style="color:#FD971F;font-style:italic;">callback</span><span style="color:#F8F8F2;">) </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#88846F;">// 这种形式就表明这是一个异步事件</span></span>\n<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#88846F;">// 处理结束后需要调用callback参数，否则流程会被一直卡在这里不会向下运行</span></span>\n<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#A6E22E;">callback</span><span style="color:#F8F8F2;">()</span></span>\n<span class="line"><span style="color:#F8F8F2;">      })</span></span>\n<span class="line"><span style="color:#F8F8F2;">    }</span></span>\n<span class="line"><span style="color:#F8F8F2;">  }</span></span></code></pre><button class="link">将此代码在线运行</button></div></li></ul></li><li>编写plugin时，可以访问compiler和compilation,通过钩子webpack执行。</li><li>事件流主要流程： <ul><li>entry-option：初始化options</li><li>run：开始编译</li><li>make：从entry开始递归的分析依赖，对每个依赖模块进行build</li><li>before-resolve - after-resolve： 对其中一个模块位置进行解析</li><li>build-module ：开始构建 (build) 这个module,这里将使用文件对应的loader加载</li><li>normal-module-loader：对用loader加载完成的module(是一段js代码)进行编译,用 acorn 编译,生成ast抽象语法树。</li><li>program： 开始对ast进行遍历，当遇到require等一些调用表达式时，触发 call require 事件的handler执行，收集依赖，并。如：AMDRequireDependenciesBlockParserPlugin等</li><li>seal： 所有依赖build完成，下面将开始对chunk进行优化，比如合并,抽取公共模块,加hash</li><li>optimize-chunk-assets：压缩代码，插件 UglifyJsPlugin 就放在这个阶段</li><li>bootstrap： 生成启动代码</li><li>emit： 把各个chunk输出到结果文件</li></ul></li></ul></li></ul><h2 id="loader和plugin的区别-常用的loader和plugin" tabindex="-1">loader和plugin的区别,常用的loader和plugin <a class="header-anchor" href="#loader和plugin的区别-常用的loader和plugin" aria-label="Permalink to &quot;loader和plugin的区别,常用的loader和plugin&quot;">​</a></h2><ul><li>loader是一个function</li><li>plugin是一个类，类似node中间件,可以贯穿整个生命周期。</li></ul><h2 id="tree-shaking" tabindex="-1">tree shaking <a class="header-anchor" href="#tree-shaking" aria-label="Permalink to &quot;tree shaking&quot;">​</a></h2><ul><li>最早是由rollup作者提出，本质是用于消除无用代码，webpack2增加了该功能。</li><li>DCE(Dead code elimination) 去除无用代码，tree shaking是DCE的一种实现方式。传统DCE是消除不可用代码，tree shaking是消除没有用到的代码》</li><li>减少文件加载体积对js意义重大</li><li>DCE特征 <ul><li>代码不会被执行，不可到达</li><li>代码执行的结果不用被用到</li><li>代码只会影响死变量（只写不读）</li></ul></li><li>传统编译器将dead code从ast中删除是通过uglify做到的。</li><li>Tree Shaking <ul><li>依赖于ES6的模块性，es6 module特点： <ul><li>只能作为模块顶层的语句出现</li><li>import的模块名只能是字符串常量</li><li>import binding是immutable(不可变)的</li></ul></li><li>tree shaking的基础：依赖关系是确定的，和运行时的状态无关，可以进行可靠的静态分析，然后消除</li><li>在rollup和webpack2，要用es module synatax才能tree-shaking</li><li>webpack tree shaking实现： <ul><li>把所有的import标记为有使用/无使用两种，在后续压缩式进行处理 <ul><li>统一标记import为/* harmony import*/</li><li>被使用过export标记为/* harmony export([type])*/</li><li>没被使用过的import被标记/* unused harmony export [FuncName]*/ FuncName为export的方法名称</li></ul></li><li>通过uglifyjs（类似其他）工具进行代码精简</li></ul></li></ul></li></ul><h2 id="rollup-webpack-closure-compiler差异" tabindex="-1">rollup,webpack,closure compiler差异 <a class="header-anchor" href="#rollup-webpack-closure-compiler差异" aria-label="Permalink to &quot;rollup,webpack,closure compiler差异&quot;">​</a></h2><ul><li>三大工具的tree-shaking对无用代码消除是有限的，closuer complier是最好的。</li></ul><h2 id="webpack5" tabindex="-1">webpack5 <a class="header-anchor" href="#webpack5" aria-label="Permalink to &quot;webpack5&quot;">​</a></h2><ul><li>通过持久化缓存提高性能</li><li>采用更好的持久化缓存算法和默认行为</li><li>通过优化tree shaking和代码生成来减少bundle体积</li><li>提高web平台的兼容性</li><li>清除之前为了webpack4没有不兼容变更导致的不合理的state</li><li>尝试现在引入重大个更改来为将来的功能做准备，以使我们能够尽可能长时间的使用webpack5</li><li>webpack也可以生成es6的代码</li></ul><h2 id="webpack优化" tabindex="-1">webpack优化 <a class="header-anchor" href="#webpack优化" aria-label="Permalink to &quot;webpack优化&quot;">​</a></h2><ul><li>优化图片，使用url-loader优化，将小图片转成base64<div class="language-js codearea-link" id="a8r06r9j77"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F8F8F2;">module: {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    rules: [{</span></span>\n<span class="line"><span style="color:#F8F8F2;">      test:</span><span style="color:#E6DB74;"> /</span><span style="color:#AE81FF;">\\.</span><span style="color:#E6DB74;">(png</span><span style="color:#F92672;">|</span><span style="color:#E6DB74;">svg</span><span style="color:#F92672;">|</span><span style="color:#E6DB74;">jpg</span><span style="color:#F92672;">|</span><span style="color:#E6DB74;">gif)</span><span style="color:#F92672;">$</span><span style="color:#E6DB74;">/</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">      use: [{</span></span>\n<span class="line"><span style="color:#F8F8F2;">        loader: </span><span style="color:#E6DB74;">&#39;url-loader&#39;</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">        options: {</span></span>\n<span class="line"><span style="color:#F8F8F2;">          limit: </span><span style="color:#AE81FF;">8192</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">          outputPath: </span><span style="color:#E6DB74;">&#39;img/&#39;</span></span>\n<span class="line"><span style="color:#F8F8F2;">        }</span></span>\n<span class="line"><span style="color:#F8F8F2;">      }]</span></span>\n<span class="line"><span style="color:#F8F8F2;">    }]</span></span>\n<span class="line"><span style="color:#F8F8F2;">  }</span></span></code></pre><button class="link">将此代码在线运行</button></div></li><li>分离第三方包 将第三方包分离出来（如axios,vue,react,vue-router等）<div class="language-js codearea-link" id="noizk9n4jec"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#88846F;">// 使用commonsChunkPlugin插件合并所有第三方包</span></span>\n<span class="line"><span style="color:#F8F8F2;">entry: {</span></span>\n<span class="line"><span style="color:#F8F8F2;">  vendor: [</span><span style="color:#E6DB74;">&#39;babel-polyfill&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E6DB74;">&#39;axios&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E6DB74;">&#39;react&#39;</span><span style="color:#F8F8F2;">,</span><span style="color:#F92672;">...</span><span style="color:#F8F8F2;">],</span></span>\n<span class="line"><span style="color:#F8F8F2;">  app: </span><span style="color:#E6DB74;">&#39;./src/main.js</span><span style="color:#F44747;">‘</span></span>\n<span class="line"><span style="color:#F8F8F2;">},</span></span>\n<span class="line"><span style="color:#F8F8F2;">plugins: [</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#F92672;">new</span><span style="color:#F8F8F2;"> webpack.optimize.</span><span style="color:#A6E22E;">CommonsChunkPlugin</span><span style="color:#F8F8F2;">({</span></span>\n<span class="line"><span style="color:#F8F8F2;">    name: </span><span style="color:#E6DB74;">&#39;verdor&#39;</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    filename: </span><span style="color:#E6DB74;">&#39;js/vendor.js&#39;</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    minChunks: </span><span style="color:#AE81FF;">Infinity</span></span>\n<span class="line"><span style="color:#F8F8F2;">  })</span></span>\n<span class="line"><span style="color:#F8F8F2;">]</span></span>\n<span class="line"><span style="color:#88846F;">// 打包时忽略以下文件</span></span>\n<span class="line"><span style="color:#F8F8F2;">  externals: {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#E6DB74;">&#39;vue&#39;</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">&#39;Vue&#39;</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#E6DB74;">&#39;vue-router&#39;</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">&#39;VueRouter&#39;</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#E6DB74;">&#39;axios&#39;</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">&#39;axios&#39;</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#E6DB74;">&#39;element-ui&#39;</span><span style="color:#F8F8F2;">: </span><span style="color:#E6DB74;">&#39;ELEMENT&#39;</span></span>\n<span class="line"><span style="color:#F8F8F2;">  },</span></span></code></pre><button class="link">将此代码在线运行</button></div></li><li>分离css文件并压缩css文件</li><li>压缩js文件<div class="language-js codearea-link" id="ax2lwewge79"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F92672;">new</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">UglifyJsPlugin</span><span style="color:#F8F8F2;">()</span></span></code></pre><button class="link">将此代码在线运行</button></div></li><li>压缩Html<div class="language-js codearea-link" id="49i2kovegv1"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F92672;">new</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">HtmlWebpackPlugin</span><span style="color:#F8F8F2;">({</span></span>\n<span class="line"><span style="color:#F8F8F2;">    template: </span><span style="color:#E6DB74;">&#39;./index.html&#39;</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    minify: {</span></span>\n<span class="line"><span style="color:#F8F8F2;">      collapseWhitespace: </span><span style="color:#AE81FF;">true</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">      removeComments: </span><span style="color:#AE81FF;">true</span></span>\n<span class="line"><span style="color:#F8F8F2;">    }</span></span>\n<span class="line"><span style="color:#F8F8F2;">  })</span></span></code></pre><button class="link">将此代码在线运行</button></div></li></ul><h3 id="webpack异步加载原理" tabindex="-1">webpack异步加载原理 <a class="header-anchor" href="#webpack异步加载原理" aria-label="Permalink to &quot;webpack异步加载原理&quot;">​</a></h3><ul><li><p>首先异步加载的模块，webpack在打包的时候会将独立打包成一个js文件（webpack如何将异步加载的模块独立打包成一个文件）(打包出来的文件开头(window[&quot;webpackJsonp&quot;]=window[&quot;webpackJsonp&quot;]||[]).push()）</p></li><li><p>然后需要加载异步模块的时候：</p></li><li><p>2.1 创建script标签，src为请求该异步模块的url，并添加到document.head里，由浏览器发起请求。</p></li><li><p>2.2 请求成功后，将异步模块添加到全局的__webpack_require__变量(该对象是用来管理全部模块)后</p></li><li><p>2.3 请求异步加载文件的import()编译后的方法会从全局的__webpack_require__变量中找到对应的模块</p></li><li><p>2.4 执行相应的业务代码并删除之前创建的script标签</p></li><li><p>异步加载文件里的import()里的回调方法的执行时机，通过利用promise的机制来实现的</p></li><li><p>webpackJsonp：chunk文件加载后的callback函数，主要将文件中的模块存储到modules对象中，同时标记chunk文件的下载情况，对于入口chunk来说，等所有的模块都放入modules之后，执行入口模块函数。</p></li><li><p><strong>webpack_require</strong>：模块加载函数，加载的策略是：根据moduleid读取，优先读取缓存installedModules，读取失败则读取modules，获取返回值，然后进行缓存。</p></li></ul><h3 id="插件功能-自动生成readme文件-标题取自插件option" tabindex="-1">插件功能：自动生成README文件，标题取自插件option <a class="header-anchor" href="#插件功能-自动生成readme文件-标题取自插件option" aria-label="Permalink to &quot;插件功能：自动生成README文件，标题取自插件option&quot;">​</a></h3><div class="language-js codearea-link" id="s01u0gv83gd"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> MY_PLUGIN_NAME </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&quot;MyReadMePlugin&quot;</span><span style="color:#F8F8F2;">;  </span></span>\n<span class="line"><span style="color:#F8F8F2;"> </span></span>\n<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#88846F;">// 插件功能：自动生成README文件，标题取自插件option  </span></span>\n<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">class</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;text-decoration:underline;">MyReadMePlugin</span><span style="color:#F8F8F2;"> {  </span></span>\n<span class="line"><span style="color:#F8F8F2;">   </span></span>\n<span class="line"><span style="color:#F8F8F2;">   </span><span style="color:#66D9EF;font-style:italic;">constructor</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">option</span><span style="color:#F8F8F2;">) {  </span></span>\n<span class="line"><span style="color:#F8F8F2;">     </span><span style="color:#FD971F;">this</span><span style="color:#F8F8F2;">.option </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> option </span><span style="color:#F92672;">||</span><span style="color:#F8F8F2;"> {};  </span></span>\n<span class="line"><span style="color:#F8F8F2;">   }  </span></span>\n<span class="line"><span style="color:#F8F8F2;">   </span></span>\n<span class="line"><span style="color:#F8F8F2;">   </span><span style="color:#A6E22E;">apply</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">compiler</span><span style="color:#F8F8F2;">) {  </span></span>\n<span class="line"><span style="color:#F8F8F2;">     compiler.hooks.emit.</span><span style="color:#A6E22E;">tapAsync</span><span style="color:#F8F8F2;">(  </span></span>\n<span class="line"><span style="color:#F8F8F2;">       MY_PLUGIN_NAME,  </span></span>\n<span class="line"><span style="color:#F8F8F2;">       (</span><span style="color:#FD971F;font-style:italic;">compilation</span><span style="color:#F8F8F2;">, </span><span style="color:#FD971F;font-style:italic;">callback</span><span style="color:#F8F8F2;">) </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> {  </span></span>\n<span class="line"><span style="color:#F8F8F2;">         compilation.assets[</span><span style="color:#E6DB74;">&quot;README.md&quot;</span><span style="color:#F8F8F2;">] </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> {  </span></span>\n<span class="line"><span style="color:#F8F8F2;">           </span><span style="color:#88846F;">// 文件内容  </span></span>\n<span class="line"><span style="color:#F8F8F2;">           </span><span style="color:#A6E22E;">source</span><span style="color:#F8F8F2;">: () </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> {  </span></span>\n<span class="line"><span style="color:#F8F8F2;">             </span><span style="color:#F92672;">return</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">`# </span><span style="color:#F92672;">${</span><span style="color:#FD971F;">this</span><span style="color:#F8F8F2;">.option.title </span><span style="color:#F92672;">||</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;默认标题&#39;</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;">`</span><span style="color:#F8F8F2;">;  </span></span>\n<span class="line"><span style="color:#F8F8F2;">           },  </span></span>\n<span class="line"><span style="color:#F8F8F2;">           </span><span style="color:#88846F;">// 文件大小  </span></span>\n<span class="line"><span style="color:#F8F8F2;">           </span><span style="color:#A6E22E;">size</span><span style="color:#F8F8F2;">: () </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">30</span><span style="color:#F8F8F2;">,  </span></span>\n<span class="line"><span style="color:#F8F8F2;">         };  </span></span>\n<span class="line"><span style="color:#F8F8F2;">         </span><span style="color:#A6E22E;">callback</span><span style="color:#F8F8F2;">();  </span></span>\n<span class="line"><span style="color:#F8F8F2;">       }  </span></span>\n<span class="line"><span style="color:#F8F8F2;">     );  </span></span>\n<span class="line"><span style="color:#F8F8F2;">   }  </span></span>\n<span class="line"><span style="color:#F8F8F2;"> }  </span></span>\n<span class="line"><span style="color:#F8F8F2;">   </span></span>\n<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#88846F;">// 7、模块导出  </span></span>\n<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">module</span><span style="color:#F8F8F2;">.</span><span style="color:#66D9EF;font-style:italic;">exports</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> MyReadMePlugin;</span></span></code></pre><button class="link">将此代码在线运行</button></div><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-label="Permalink to &quot;参考&quot;">​</a></h2><ul><li>[<a href="https://mp.weixin.qq.com/s/2GaTS9_-ErJf15AIAFdoLw" target="_blank" rel="noreferrer">https://mp.weixin.qq.com/s/2GaTS9_-ErJf15AIAFdoLw</a>]</li><li>[<a href="https://www.cnblogs.com/libin-1/p/6938581.html" target="_blank" rel="noreferrer">https://www.cnblogs.com/libin-1/p/6938581.html</a>]</li></ul>', 24)
  ]));
}
const webpack = /* @__PURE__ */ _export_sfc(_sfc_main, [["render", _sfc_render]]);
export {
  __pageData,
  webpack as default
};
