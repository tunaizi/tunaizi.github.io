import { _ as _export_sfc, r as r3, i as it, w as ig } from "./chunks/framework.4a4ad33e.js";
const _imports_0 = "/assets/shange.980a969d.png";
const __pageData = JSON.parse('{"title":"栅格图形系统","description":"","frontmatter":{},"headers":[{"level":2,"title":"基本概念","slug":"基本概念","link":"#基本概念","children":[]},{"level":2,"title":"主要特点","slug":"主要特点","link":"#主要特点","children":[{"level":3,"title":"1. 像素构成","slug":"_1-像素构成","link":"#_1-像素构成","children":[]},{"level":3,"title":"2. 颜色深度","slug":"_2-颜色深度","link":"#_2-颜色深度","children":[]},{"level":3,"title":"3. 图像格式","slug":"_3-图像格式","link":"#_3-图像格式","children":[]}]},{"level":2,"title":"技术特点","slug":"技术特点","link":"#技术特点","children":[{"level":3,"title":"1. 分辨率依赖","slug":"_1-分辨率依赖","link":"#_1-分辨率依赖","children":[]},{"level":3,"title":"2. 内存占用","slug":"_2-内存占用","link":"#_2-内存占用","children":[]},{"level":3,"title":"3. 图像处理","slug":"_3-图像处理","link":"#_3-图像处理","children":[]}]},{"level":2,"title":"应用场景","slug":"应用场景","link":"#应用场景","children":[{"level":3,"title":"1. 照片处理","slug":"_1-照片处理","link":"#_1-照片处理","children":[]},{"level":3,"title":"2. 游戏图形","slug":"_2-游戏图形","link":"#_2-游戏图形","children":[]},{"level":3,"title":"3. UI 设计","slug":"_3-ui-设计","link":"#_3-ui-设计","children":[]}]},{"level":2,"title":"优缺点","slug":"优缺点","link":"#优缺点","children":[{"level":3,"title":"1. 优点","slug":"_1-优点","link":"#_1-优点","children":[]},{"level":3,"title":"2. 缺点","slug":"_2-缺点","link":"#_2-缺点","children":[]}]},{"level":2,"title":"性能优化","slug":"性能优化","link":"#性能优化","children":[{"level":3,"title":"1. 图像压缩","slug":"_1-图像压缩","link":"#_1-图像压缩","children":[]},{"level":3,"title":"2. 响应式图像","slug":"_2-响应式图像","link":"#_2-响应式图像","children":[]},{"level":3,"title":"3. 懒加载","slug":"_3-懒加载","link":"#_3-懒加载","children":[]}]},{"level":2,"title":"最佳实践","slug":"最佳实践","link":"#最佳实践","children":[{"level":3,"title":"1. 格式选择","slug":"_1-格式选择","link":"#_1-格式选择","children":[]},{"level":3,"title":"2. 尺寸优化","slug":"_2-尺寸优化","link":"#_2-尺寸优化","children":[]},{"level":3,"title":"3. 加载策略","slug":"_3-加载策略","link":"#_3-加载策略","children":[]}]},{"level":2,"title":"JS图片压缩插件","slug":"js图片压缩插件","link":"#js图片压缩插件","children":[]},{"level":2,"title":"基本使用","slug":"基本使用","link":"#基本使用","children":[{"level":3,"title":"1. 安装","slug":"_1-安装","link":"#_1-安装","children":[]},{"level":3,"title":"2. 基础示例","slug":"_2-基础示例","link":"#_2-基础示例","children":[]}]},{"level":2,"title":"高级配置","slug":"高级配置","link":"#高级配置","children":[{"level":3,"title":"1. 完整配置选项","slug":"_1-完整配置选项","link":"#_1-完整配置选项","children":[]},{"level":3,"title":"2. 带进度监控的示例","slug":"_2-带进度监控的示例","link":"#_2-带进度监控的示例","children":[]}]},{"level":2,"title":"实际应用场景","slug":"实际应用场景","link":"#实际应用场景","children":[{"level":3,"title":"1. 图片上传前压缩","slug":"_1-图片上传前压缩","link":"#_1-图片上传前压缩","children":[]},{"level":3,"title":"2. 批量图片处理","slug":"_2-批量图片处理","link":"#_2-批量图片处理","children":[]}]},{"level":2,"title":"最佳实践","slug":"最佳实践-1","link":"#最佳实践-1","children":[{"level":3,"title":"1. 根据设备性能调整","slug":"_1-根据设备性能调整","link":"#_1-根据设备性能调整","children":[]},{"level":3,"title":"2. 错误处理","slug":"_2-错误处理","link":"#_2-错误处理","children":[]}]}],"relativePath":"start-docs/D-html/栅格系统.md","filePath":"start-docs/D-html/栅格系统.md"}');
const _sfc_main = { name: "start-docs/D-html/栅格系统.md" };
function _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {
  return r3(), it("div", null, _cache[0] || (_cache[0] = [
    ig('<h1 id="栅格图形系统" tabindex="-1">栅格图形系统 <a class="header-anchor" href="#栅格图形系统" aria-label="Permalink to &quot;栅格图形系统&quot;">​</a></h1><p><img src="' + _imports_0 + '" alt="栅格"></p><h2 id="基本概念" tabindex="-1">基本概念 <a class="header-anchor" href="#基本概念" aria-label="Permalink to &quot;基本概念&quot;">​</a></h2><p>栅格图形（Raster Graphics）也称为位图（Bitmap），是由像素点阵组成的图像。每个像素都包含颜色信息，整体构成完整的图像。</p><h2 id="主要特点" tabindex="-1">主要特点 <a class="header-anchor" href="#主要特点" aria-label="Permalink to &quot;主要特点&quot;">​</a></h2><h3 id="_1-像素构成" tabindex="-1">1. 像素构成 <a class="header-anchor" href="#_1-像素构成" aria-label="Permalink to &quot;1. 像素构成&quot;">​</a></h3><div class="language-js codearea-link" id="i4w31uffahn"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#88846F;">// 像素矩阵示例</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> pixels </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> [</span></span>\n<span class="line"><span style="color:#F8F8F2;">  [</span><span style="color:#AE81FF;">255</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">], </span><span style="color:#88846F;">// 红色像素</span></span>\n<span class="line"><span style="color:#F8F8F2;">  [</span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">255</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">], </span><span style="color:#88846F;">// 绿色像素</span></span>\n<span class="line"><span style="color:#F8F8F2;">  [</span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">255</span><span style="color:#F8F8F2;">] </span><span style="color:#88846F;">// 蓝色像素</span></span>\n<span class="line"><span style="color:#F8F8F2;">]</span></span>\n<span class="line"><span style="color:#88846F;">//由固定数量的像素组成由固定数量的像素组成由固定数量的像素组成由固定数量的像素组成由固定数量的像素组成由固定数量的像素组成由固定数量的像素组成由固定数量的像素组成由固定数量的像素组成由固定数量的像素组成由固定数量的像素组成由固定数量的像素组成由固定数量的像素组成由固定数量的像素组成</span></span></code></pre><button class="link">将此代码在线运行</button></div><ul><li>由固定数量的像素组成</li><li>每个像素都有特定的颜色值</li><li>分辨率决定图像质量</li></ul><h3 id="_2-颜色深度" tabindex="-1">2. 颜色深度 <a class="header-anchor" href="#_2-颜色深度" aria-label="Permalink to &quot;2. 颜色深度&quot;">​</a></h3><ul><li>8 位：256 种颜色</li><li>16 位：65,536 种颜色</li><li>24 位：1600 万种颜色</li><li>32 位：带透明通道的真彩色</li></ul><h3 id="_3-图像格式" tabindex="-1">3. 图像格式 <a class="header-anchor" href="#_3-图像格式" aria-label="Permalink to &quot;3. 图像格式&quot;">​</a></h3><ol><li><p><strong>无损格式</strong></p><ul><li>PNG：支持透明度</li><li>GIF：支持动画</li><li>BMP：无压缩原始格式</li></ul></li><li><p><strong>有损格式</strong></p><ul><li>JPEG：适合照片</li><li>WebP：Google 开发的现代格式</li><li>AVIF：新一代图像格式</li></ul></li></ol><h2 id="技术特点" tabindex="-1">技术特点 <a class="header-anchor" href="#技术特点" aria-label="Permalink to &quot;技术特点&quot;">​</a></h2><h3 id="_1-分辨率依赖" tabindex="-1">1. 分辨率依赖 <a class="header-anchor" href="#_1-分辨率依赖" aria-label="Permalink to &quot;1. 分辨率依赖&quot;">​</a></h3><div class="language-js codearea-link" id="bnp29cukukg"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#88846F;">// 图像尺寸计算</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> width </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">1920</span><span style="color:#F8F8F2;"> </span><span style="color:#88846F;">// 像素宽度</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> height </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">1080</span><span style="color:#F8F8F2;"> </span><span style="color:#88846F;">// 像素高度</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> totalPixels </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> width </span><span style="color:#F92672;">*</span><span style="color:#F8F8F2;"> height </span><span style="color:#88846F;">// 总像素数</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> bytesPerPixel </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">3</span><span style="color:#F8F8F2;"> </span><span style="color:#88846F;">// RGB每像素3字节</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> fileSize </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> totalPixels </span><span style="color:#F92672;">*</span><span style="color:#F8F8F2;"> bytesPerPixel </span><span style="color:#88846F;">// 文件大小（未压缩）</span></span></code></pre><button class="link">将此代码在线运行</button></div><ul><li>放大会失真</li><li>缩小可能丢失细节</li><li>文件大小与分辨率直接相关</li></ul><h3 id="_2-内存占用" tabindex="-1">2. 内存占用 <a class="header-anchor" href="#_2-内存占用" aria-label="Permalink to &quot;2. 内存占用&quot;">​</a></h3><div class="language-js codearea-link" id="wyhuz8vd9tb"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#88846F;">// 内存占用计算</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> imageWidth </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">1000</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> imageHeight </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">800</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> bytesPerPixel </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">4</span><span style="color:#F8F8F2;"> </span><span style="color:#88846F;">// RGBA</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> memoryUsage </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> imageWidth </span><span style="color:#F92672;">*</span><span style="color:#F8F8F2;"> imageHeight </span><span style="color:#F92672;">*</span><span style="color:#F8F8F2;"> bytesPerPixel </span><span style="color:#88846F;">// 字节数</span></span></code></pre><button class="link">将此代码在线运行</button></div><ul><li>与图像尺寸成正比</li><li>与颜色深度相关</li><li>需要考虑内存管理</li></ul><h3 id="_3-图像处理" tabindex="-1">3. 图像处理 <a class="header-anchor" href="#_3-图像处理" aria-label="Permalink to &quot;3. 图像处理&quot;">​</a></h3><div class="language-js codearea-link" id="lloizg8n488"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#88846F;">// Canvas 图像处理示例</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> canvas </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> document.</span><span style="color:#A6E22E;">createElement</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;canvas&#39;</span><span style="color:#F8F8F2;">)</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> ctx </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> canvas.</span><span style="color:#A6E22E;">getContext</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;2d&#39;</span><span style="color:#F8F8F2;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#88846F;">// 调整亮度</span></span>\n<span class="line"><span style="color:#F8F8F2;">ctx.filter </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;brightness(150%)&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#88846F;">// 模糊效果</span></span>\n<span class="line"><span style="color:#F8F8F2;">ctx.filter </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;blur(5px)&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#88846F;">// 灰度转换</span></span>\n<span class="line"><span style="color:#F8F8F2;">ctx.filter </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;grayscale(100%)&#39;</span></span></code></pre><button class="link">将此代码在线运行</button></div><h2 id="应用场景" tabindex="-1">应用场景 <a class="header-anchor" href="#应用场景" aria-label="Permalink to &quot;应用场景&quot;">​</a></h2><h3 id="_1-照片处理" tabindex="-1">1. 照片处理 <a class="header-anchor" href="#_1-照片处理" aria-label="Permalink to &quot;1. 照片处理&quot;">​</a></h3><ul><li>数码相机图像</li><li>照片编辑</li><li>图像存储</li></ul><h3 id="_2-游戏图形" tabindex="-1">2. 游戏图形 <a class="header-anchor" href="#_2-游戏图形" aria-label="Permalink to &quot;2. 游戏图形&quot;">​</a></h3><div class="language-js codearea-link" id="bvn6j3a38wv"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#88846F;">// 游戏精灵图示例</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> sprite </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">  x: </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">  y: </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">  width: </span><span style="color:#AE81FF;">32</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">  height: </span><span style="color:#AE81FF;">32</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">  frameCount: </span><span style="color:#AE81FF;">8</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">  currentFrame: </span><span style="color:#AE81FF;">0</span></span>\n<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><button class="link">将此代码在线运行</button></div><ul><li>游戏贴图</li><li>精灵动画</li><li>背景图像</li></ul><h3 id="_3-ui-设计" tabindex="-1">3. UI 设计 <a class="header-anchor" href="#_3-ui-设计" aria-label="Permalink to &quot;3. UI 设计&quot;">​</a></h3><ul><li>图标和按钮</li><li>背景纹理</li><li>界面装饰</li></ul><h2 id="优缺点" tabindex="-1">优缺点 <a class="header-anchor" href="#优缺点" aria-label="Permalink to &quot;优缺点&quot;">​</a></h2><h3 id="_1-优点" tabindex="-1">1. 优点 <a class="header-anchor" href="#_1-优点" aria-label="Permalink to &quot;1. 优点&quot;">​</a></h3><ul><li>表现力强</li><li>真实感好</li><li>适合复杂图像</li><li>硬件加速支持好</li></ul><h3 id="_2-缺点" tabindex="-1">2. 缺点 <a class="header-anchor" href="#_2-缺点" aria-label="Permalink to &quot;2. 缺点&quot;">​</a></h3><ul><li>缩放质量受限</li><li>文件体积较大</li><li>编辑不够灵活</li><li>不适合简单图形</li></ul><h2 id="性能优化" tabindex="-1">性能优化 <a class="header-anchor" href="#性能优化" aria-label="Permalink to &quot;性能优化&quot;">​</a></h2><h3 id="_1-图像压缩" tabindex="-1">1. 图像压缩 <a class="header-anchor" href="#_1-图像压缩" aria-label="Permalink to &quot;1. 图像压缩&quot;">​</a></h3><p><a href="#JS图片压缩插件">图片压缩插件- imageCompression</a></p><div class="language-js codearea-link" id="05cye7mibuv4"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#88846F;">// 图像压缩示例</span></span>\n<span class="line"><span style="color:#F92672;">async</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">compressImage</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">file</span><span style="color:#F8F8F2;">) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> options </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    maxSizeMB: </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    maxWidthOrHeight: </span><span style="color:#AE81FF;">1920</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    useWebWorker: </span><span style="color:#AE81FF;">true</span></span>\n<span class="line"><span style="color:#F8F8F2;">  }</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#F92672;">try</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> compressedFile </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">imageCompression</span><span style="color:#F8F8F2;">(file, options)</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#F92672;">return</span><span style="color:#F8F8F2;"> compressedFile</span></span>\n<span class="line"><span style="color:#F8F8F2;">  } </span><span style="color:#F92672;">catch</span><span style="color:#F8F8F2;"> (error) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    console.</span><span style="color:#A6E22E;">log</span><span style="color:#F8F8F2;">(error)</span></span>\n<span class="line"><span style="color:#F8F8F2;">  }</span></span>\n<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><button class="link">将此代码在线运行</button></div><h3 id="_2-响应式图像" tabindex="-1">2. 响应式图像 <a class="header-anchor" href="#_2-响应式图像" aria-label="Permalink to &quot;2. 响应式图像&quot;">​</a></h3><div class="language-html codearea-link" id="mirhwoyi8ad"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#F92672;">picture</span><span style="color:#F8F8F2;">&gt;</span></span>\n<span class="line"><span style="color:#F8F8F2;">  &lt;</span><span style="color:#F92672;">source</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">media</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;(min-width: 800px)&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">srcset</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;large.jpg&quot;</span><span style="color:#F8F8F2;"> /&gt;</span></span>\n<span class="line"><span style="color:#F8F8F2;">  &lt;</span><span style="color:#F92672;">source</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">media</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;(min-width: 400px)&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">srcset</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;medium.jpg&quot;</span><span style="color:#F8F8F2;"> /&gt;</span></span>\n<span class="line"><span style="color:#F8F8F2;">  &lt;</span><span style="color:#F92672;">img</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">src</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;small.jpg&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">alt</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;响应式图像&quot;</span><span style="color:#F8F8F2;"> /&gt;</span></span>\n<span class="line"><span style="color:#F8F8F2;">&lt;/</span><span style="color:#F92672;">picture</span><span style="color:#F8F8F2;">&gt;</span></span></code></pre><button class="link">将此代码在线运行</button></div><h3 id="_3-懒加载" tabindex="-1">3. 懒加载 <a class="header-anchor" href="#_3-懒加载" aria-label="Permalink to &quot;3. 懒加载&quot;">​</a></h3><div class="language-html codearea-link" id="6zfgmud9u6a"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#F92672;">img</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#A6E22E;">src</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;placeholder.jpg&quot;</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#A6E22E;">data-src</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;actual-image.jpg&quot;</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#A6E22E;">loading</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;lazy&quot;</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#A6E22E;">alt</span><span style="color:#F8F8F2;">=</span><span style="color:#E6DB74;">&quot;懒加载图像&quot;</span></span>\n<span class="line"><span style="color:#F8F8F2;">/&gt;</span></span></code></pre><button class="link">将此代码在线运行</button></div><h2 id="最佳实践" tabindex="-1">最佳实践 <a class="header-anchor" href="#最佳实践" aria-label="Permalink to &quot;最佳实践&quot;">​</a></h2><h3 id="_1-格式选择" tabindex="-1">1. 格式选择 <a class="header-anchor" href="#_1-格式选择" aria-label="Permalink to &quot;1. 格式选择&quot;">​</a></h3><ul><li>照片使用 JPEG</li><li>需要透明度使用 PNG</li><li>动画使用 GIF 或 WebP</li><li>考虑使用现代格式(WebP/AVIF)</li></ul><h3 id="_2-尺寸优化" tabindex="-1">2. 尺寸优化 <a class="header-anchor" href="#_2-尺寸优化" aria-label="Permalink to &quot;2. 尺寸优化&quot;">​</a></h3><div class="language-js codearea-link" id="5jghhv4tcod"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#88846F;">// 计算最佳尺寸</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">calculateOptimalSize</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">originalWidth</span><span style="color:#F8F8F2;">, </span><span style="color:#FD971F;font-style:italic;">originalHeight</span><span style="color:#F8F8F2;">, </span><span style="color:#FD971F;font-style:italic;">maxWidth</span><span style="color:#F8F8F2;">) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> ratio </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> originalHeight </span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;"> originalWidth</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> width </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> Math.</span><span style="color:#A6E22E;">min</span><span style="color:#F8F8F2;">(originalWidth, maxWidth)</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> height </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> Math.</span><span style="color:#A6E22E;">round</span><span style="color:#F8F8F2;">(width </span><span style="color:#F92672;">*</span><span style="color:#F8F8F2;"> ratio)</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#F92672;">return</span><span style="color:#F8F8F2;"> { width, height }</span></span>\n<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><button class="link">将此代码在线运行</button></div><h3 id="_3-加载策略" tabindex="-1">3. 加载策略 <a class="header-anchor" href="#_3-加载策略" aria-label="Permalink to &quot;3. 加载策略&quot;">​</a></h3><ul><li>使用 CDN</li><li>实现懒加载</li><li>提供响应式版本</li><li>使用适当的压缩</li></ul><h2 id="js图片压缩插件" tabindex="-1">JS图片压缩插件 <a class="header-anchor" href="#js图片压缩插件" aria-label="Permalink to &quot;JS图片压缩插件&quot;">​</a></h2><p>imageCompression 是一个用于在浏览器中压缩图片的 JavaScript 库，它可以在上传前压缩图片，减少传输数据量。</p><h2 id="基本使用" tabindex="-1">基本使用 <a class="header-anchor" href="#基本使用" aria-label="Permalink to &quot;基本使用&quot;">​</a></h2><h3 id="_1-安装" tabindex="-1">1. 安装 <a class="header-anchor" href="#_1-安装" aria-label="Permalink to &quot;1. 安装&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki monokai"><code><span class="line"><span style="color:#A6E22E;">npm</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">install</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">browser-image-compression</span></span>\n<span class="line"><span style="color:#88846F;"># 或</span></span>\n<span class="line"><span style="color:#A6E22E;">yarn</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">add</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">browser-image-compression</span></span></code></pre></div><h3 id="_2-基础示例" tabindex="-1">2. 基础示例 <a class="header-anchor" href="#_2-基础示例" aria-label="Permalink to &quot;2. 基础示例&quot;">​</a></h3><div class="language-js codearea-link" id="3bpml57c10k"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> imageCompression </span><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;browser-image-compression&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F92672;">async</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">compressImage</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">file</span><span style="color:#F8F8F2;">) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> options </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    maxSizeMB: </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#88846F;">// 压缩后最大文件大小</span></span>\n<span class="line"><span style="color:#F8F8F2;">    maxWidthOrHeight: </span><span style="color:#AE81FF;">1920</span><span style="color:#F8F8F2;">, </span><span style="color:#88846F;">// 最大宽度或高度</span></span>\n<span class="line"><span style="color:#F8F8F2;">    useWebWorker: </span><span style="color:#AE81FF;">true</span><span style="color:#F8F8F2;"> </span><span style="color:#88846F;">// 使用 Web Worker 进行压缩</span></span>\n<span class="line"><span style="color:#F8F8F2;">  }</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#F92672;">try</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> compressedFile </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">imageCompression</span><span style="color:#F8F8F2;">(file, options)</span></span>\n<span class="line"><span style="color:#F8F8F2;">    console.</span><span style="color:#A6E22E;">log</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;原始文件大小：&#39;</span><span style="color:#F8F8F2;">, file.size </span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">1024</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">1024</span><span style="color:#F8F8F2;">, </span><span style="color:#E6DB74;">&#39;MB&#39;</span><span style="color:#F8F8F2;">)</span></span>\n<span class="line"><span style="color:#F8F8F2;">    console.</span><span style="color:#A6E22E;">log</span><span style="color:#F8F8F2;">(</span></span>\n<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#E6DB74;">&#39;压缩后文件大小：&#39;</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">      compressedFile.size </span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">1024</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">1024</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#E6DB74;">&#39;MB&#39;</span></span>\n<span class="line"><span style="color:#F8F8F2;">    )</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#F92672;">return</span><span style="color:#F8F8F2;"> compressedFile</span></span>\n<span class="line"><span style="color:#F8F8F2;">  } </span><span style="color:#F92672;">catch</span><span style="color:#F8F8F2;"> (error) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    console.</span><span style="color:#A6E22E;">error</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;压缩失败:&#39;</span><span style="color:#F8F8F2;">, error)</span></span>\n<span class="line"><span style="color:#F8F8F2;">  }</span></span>\n<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><button class="link">将此代码在线运行</button></div><h2 id="高级配置" tabindex="-1">高级配置 <a class="header-anchor" href="#高级配置" aria-label="Permalink to &quot;高级配置&quot;">​</a></h2><h3 id="_1-完整配置选项" tabindex="-1">1. 完整配置选项 <a class="header-anchor" href="#_1-完整配置选项" aria-label="Permalink to &quot;1. 完整配置选项&quot;">​</a></h3><div class="language-js codearea-link" id="pbycxlspowj"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> options </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">  maxSizeMB: </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#88846F;">// 压缩后的最大文件大小</span></span>\n<span class="line"><span style="color:#F8F8F2;">  maxWidthOrHeight: </span><span style="color:#AE81FF;">1920</span><span style="color:#F8F8F2;">, </span><span style="color:#88846F;">// 最大宽度/高度</span></span>\n<span class="line"><span style="color:#F8F8F2;">  useWebWorker: </span><span style="color:#AE81FF;">true</span><span style="color:#F8F8F2;">, </span><span style="color:#88846F;">// 使用 Web Worker</span></span>\n<span class="line"><span style="color:#F8F8F2;">  maxIteration: </span><span style="color:#AE81FF;">10</span><span style="color:#F8F8F2;">, </span><span style="color:#88846F;">// 最大压缩次数</span></span>\n<span class="line"><span style="color:#F8F8F2;">  exifOrientation: </span><span style="color:#F92672;">-</span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#88846F;">// EXIF 方向</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#A6E22E;">onProgress</span><span style="color:#F8F8F2;">: (</span><span style="color:#FD971F;font-style:italic;">progress</span><span style="color:#F8F8F2;">) </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> {}, </span><span style="color:#88846F;">// 压缩进度回调</span></span>\n<span class="line"><span style="color:#F8F8F2;">  initialQuality: </span><span style="color:#AE81FF;">0.7</span><span style="color:#F8F8F2;">, </span><span style="color:#88846F;">// 初始压缩质量</span></span>\n<span class="line"><span style="color:#F8F8F2;">  fileType: </span><span style="color:#E6DB74;">&#39;image/jpeg&#39;</span><span style="color:#F8F8F2;"> </span><span style="color:#88846F;">// 输出文件类型</span></span>\n<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><button class="link">将此代码在线运行</button></div><h3 id="_2-带进度监控的示例" tabindex="-1">2. 带进度监控的示例 <a class="header-anchor" href="#_2-带进度监控的示例" aria-label="Permalink to &quot;2. 带进度监控的示例&quot;">​</a></h3><div class="language-js codearea-link" id="37dxem31fbj"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F92672;">async</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">compressWithProgress</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">file</span><span style="color:#F8F8F2;">) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> options </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    maxSizeMB: </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    maxWidthOrHeight: </span><span style="color:#AE81FF;">1920</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    useWebWorker: </span><span style="color:#AE81FF;">true</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#A6E22E;">onProgress</span><span style="color:#F8F8F2;">: (</span><span style="color:#FD971F;font-style:italic;">progress</span><span style="color:#F8F8F2;">) </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">      console.</span><span style="color:#A6E22E;">log</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;压缩进度：&#39;</span><span style="color:#F8F8F2;">, progress)</span></span>\n<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#88846F;">// 更新UI进度条</span></span>\n<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#A6E22E;">updateProgressBar</span><span style="color:#F8F8F2;">(progress)</span></span>\n<span class="line"><span style="color:#F8F8F2;">    }</span></span>\n<span class="line"><span style="color:#F8F8F2;">  }</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#F92672;">try</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> result </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">imageCompression</span><span style="color:#F8F8F2;">(file, options)</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#F92672;">return</span><span style="color:#F8F8F2;"> result</span></span>\n<span class="line"><span style="color:#F8F8F2;">  } </span><span style="color:#F92672;">catch</span><span style="color:#F8F8F2;"> (error) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    console.</span><span style="color:#A6E22E;">error</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;压缩失败:&#39;</span><span style="color:#F8F8F2;">, error)</span></span>\n<span class="line"><span style="color:#F8F8F2;">  }</span></span>\n<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><button class="link">将此代码在线运行</button></div><h2 id="实际应用场景" tabindex="-1">实际应用场景 <a class="header-anchor" href="#实际应用场景" aria-label="Permalink to &quot;实际应用场景&quot;">​</a></h2><h3 id="_1-图片上传前压缩" tabindex="-1">1. 图片上传前压缩 <a class="header-anchor" href="#_1-图片上传前压缩" aria-label="Permalink to &quot;1. 图片上传前压缩&quot;">​</a></h3><div class="language-js codearea-link" id="cbx6vv0g45l"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F92672;">async</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">handleImageUpload</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">event</span><span style="color:#F8F8F2;">) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> file </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> event.target.files[</span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">]</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#88846F;">// 检查文件大小</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#F92672;">if</span><span style="color:#F8F8F2;"> (file.size </span><span style="color:#F92672;">&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">1024</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">*</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">1024</span><span style="color:#F8F8F2;">) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#88846F;">// 大于1MB时压缩</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> compressed </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">compressImage</span><span style="color:#F8F8F2;">(file)</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#A6E22E;">uploadToServer</span><span style="color:#F8F8F2;">(compressed)</span></span>\n<span class="line"><span style="color:#F8F8F2;">  } </span><span style="color:#F92672;">else</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#A6E22E;">uploadToServer</span><span style="color:#F8F8F2;">(file)</span></span>\n<span class="line"><span style="color:#F8F8F2;">  }</span></span>\n<span class="line"><span style="color:#F8F8F2;">}</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#88846F;">// 文件上传</span></span>\n<span class="line"><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">uploadToServer</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">file</span><span style="color:#F8F8F2;">) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> formData </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">new</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">FormData</span><span style="color:#F8F8F2;">()</span></span>\n<span class="line"><span style="color:#F8F8F2;">  formData.</span><span style="color:#A6E22E;">append</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;image&#39;</span><span style="color:#F8F8F2;">, file)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#A6E22E;">fetch</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;/upload&#39;</span><span style="color:#F8F8F2;">, {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    method: </span><span style="color:#E6DB74;">&#39;POST&#39;</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    body: formData</span></span>\n<span class="line"><span style="color:#F8F8F2;">  })</span></span>\n<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><button class="link">将此代码在线运行</button></div><h3 id="_2-批量图片处理" tabindex="-1">2. 批量图片处理 <a class="header-anchor" href="#_2-批量图片处理" aria-label="Permalink to &quot;2. 批量图片处理&quot;">​</a></h3><div class="language-js codearea-link" id="rknpaue6fi"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F92672;">async</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">handleMultipleImages</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">files</span><span style="color:#F8F8F2;">) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> options </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    maxSizeMB: </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    maxWidthOrHeight: </span><span style="color:#AE81FF;">1920</span></span>\n<span class="line"><span style="color:#F8F8F2;">  }</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> compressPromises </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> Array.</span><span style="color:#A6E22E;">from</span><span style="color:#F8F8F2;">(files).</span><span style="color:#A6E22E;">map</span><span style="color:#F8F8F2;">((</span><span style="color:#FD971F;font-style:italic;">file</span><span style="color:#F8F8F2;">) </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#A6E22E;">imageCompression</span><span style="color:#F8F8F2;">(file, options)</span></span>\n<span class="line"><span style="color:#F8F8F2;">  )</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#F92672;">try</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> compressedFiles </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">Promise</span><span style="color:#F8F8F2;">.</span><span style="color:#A6E22E;">all</span><span style="color:#F8F8F2;">(compressPromises)</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#F92672;">return</span><span style="color:#F8F8F2;"> compressedFiles</span></span>\n<span class="line"><span style="color:#F8F8F2;">  } </span><span style="color:#F92672;">catch</span><span style="color:#F8F8F2;"> (error) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    console.</span><span style="color:#A6E22E;">error</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;批量压缩失败:&#39;</span><span style="color:#F8F8F2;">, error)</span></span>\n<span class="line"><span style="color:#F8F8F2;">  }</span></span>\n<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><button class="link">将此代码在线运行</button></div><h2 id="最佳实践-1" tabindex="-1">最佳实践 <a class="header-anchor" href="#最佳实践-1" aria-label="Permalink to &quot;最佳实践&quot;">​</a></h2><h3 id="_1-根据设备性能调整" tabindex="-1">1. 根据设备性能调整 <a class="header-anchor" href="#_1-根据设备性能调整" aria-label="Permalink to &quot;1. 根据设备性能调整&quot;">​</a></h3><div class="language-js codearea-link" id="xocymzq84aj"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">getCompressionOptions</span><span style="color:#F8F8F2;">() {</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> isMobile </span><span style="color:#F92672;">=</span><span style="color:#E6DB74;"> /iPhone</span><span style="color:#F92672;">|</span><span style="color:#E6DB74;">iPad</span><span style="color:#F92672;">|</span><span style="color:#E6DB74;">iPod</span><span style="color:#F92672;">|</span><span style="color:#E6DB74;">Android/</span><span style="color:#F92672;">i</span><span style="color:#F8F8F2;">.</span><span style="color:#A6E22E;">test</span><span style="color:#F8F8F2;">(navigator.userAgent)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#F92672;">return</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    maxSizeMB: isMobile </span><span style="color:#F92672;">?</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">0.5</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    maxWidthOrHeight: isMobile </span><span style="color:#F92672;">?</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">1280</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">1920</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    useWebWorker: </span><span style="color:#AE81FF;">true</span><span style="color:#F8F8F2;">,</span></span>\n<span class="line"><span style="color:#F8F8F2;">    initialQuality: isMobile </span><span style="color:#F92672;">?</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">0.5</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">0.7</span></span>\n<span class="line"><span style="color:#F8F8F2;">  }</span></span>\n<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><button class="link">将此代码在线运行</button></div><h3 id="_2-错误处理" tabindex="-1">2. 错误处理 <a class="header-anchor" href="#_2-错误处理" aria-label="Permalink to &quot;2. 错误处理&quot;">​</a></h3><div class="language-js codearea-link" id="iivdilzjmpr"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F92672;">async</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">safeImageCompression</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">file</span><span style="color:#F8F8F2;">) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#F92672;">try</span><span style="color:#F8F8F2;"> {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#88846F;">// 检查文件类型</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#F92672;">if</span><span style="color:#F8F8F2;"> (</span><span style="color:#F92672;">!</span><span style="color:#F8F8F2;">file.type.</span><span style="color:#A6E22E;">startsWith</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;image/&#39;</span><span style="color:#F8F8F2;">)) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#F92672;">throw</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">new</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">Error</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;不是有效的图片文件&#39;</span><span style="color:#F8F8F2;">)</span></span>\n<span class="line"><span style="color:#F8F8F2;">    }</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> options </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">getCompressionOptions</span><span style="color:#F8F8F2;">()</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> compressed </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">imageCompression</span><span style="color:#F8F8F2;">(file, options)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#88846F;">// 验证压缩结果</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#F92672;">if</span><span style="color:#F8F8F2;"> (compressed.size </span><span style="color:#F92672;">&gt;=</span><span style="color:#F8F8F2;"> file.size) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">      console.</span><span style="color:#A6E22E;">warn</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;压缩后文件更大，使用原文件&#39;</span><span style="color:#F8F8F2;">)</span></span>\n<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#F92672;">return</span><span style="color:#F8F8F2;"> file</span></span>\n<span class="line"><span style="color:#F8F8F2;">    }</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#F92672;">return</span><span style="color:#F8F8F2;"> compressed</span></span>\n<span class="line"><span style="color:#F8F8F2;">  } </span><span style="color:#F92672;">catch</span><span style="color:#F8F8F2;"> (error) {</span></span>\n<span class="line"><span style="color:#F8F8F2;">    console.</span><span style="color:#A6E22E;">error</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;压缩过程出错:&#39;</span><span style="color:#F8F8F2;">, error)</span></span>\n<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#F92672;">throw</span><span style="color:#F8F8F2;"> error</span></span>\n<span class="line"><span style="color:#F8F8F2;">  }</span></span>\n<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre><button class="link">将此代码在线运行</button></div>', 71)
  ]));
}
const ____ = /* @__PURE__ */ _export_sfc(_sfc_main, [["render", _sfc_render]]);
export {
  __pageData,
  ____ as default
};
